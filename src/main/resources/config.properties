port=8080
number_tread_from_serverGroup=5
SQL_select_users_id_from_users_where_phone_password=SELECT id FROM messenger.users WHERE phone= '%1$s' and password ='%2$s';
SQL_select_users_id_from_users_where_phone=SELECT id FROM messenger.users WHERE phone= '%1$s';
SQL_select_devises_id_from_devices_where_users_id_device_token = SELECT id FROM messenger.devices where users_id =  %1$s and device_token=  '%2$s';
SQL_insert_into_devices_users_id_device_info_device_token=INSERT into messenger.devices   ( users_id, device_info,device_token) VALUE (%1$s,'%2$s','%3$s');
SQL_select_valid_token_from_access_where_users_id_devices_id=SELECT token,valid_until FROM messenger.access WHERE users_id = %1$s AND devices_id = %2$s AND deleted_at is null  ORDER BY valid_until desc;
SQL_insert_into_access_users_id_token_created_at_devices_id_valid_until=INSERT into messenger.access   ( users_id,token,created_at,devices_id,valid_until) VALUE (%1$s,'%2$s','%3$s',%4$s,'%5$s');
SQL_select_all_from_users_where_users_id=SELECT * FROM messenger.users WHERE id= %1$s;
SQL_insert_into_users_phone_email_password_first_name_last_name_user_name_created_at_=INSERT into messenger.users   ( phone,email,password,first_name,last_name,user_name,created_at, updated_at, last_online_at) VALUE ('%1$s','%2$s','%3$s','%4$s','%5$s','%6$s','%7$s','%8$s','%9$s');
SQL_select_users_id_from_users_where_user_name=SELECT id FROM messenger.users WHERE user_name= '%1$s';
SQL_insert_into_contacts_phone_email_first_name_last_name_created_at=INSERT into messenger.contacts   ( phone,email,first_name,last_name,created_at) VALUE ('%1$s','%2$s','%3$s','%4$s','%5$s');
SQL_select_contacts_id_from_contacts_where_phone=SELECT id FROM messenger.contacts WHERE phone= '%1$s';
SQL_update_contacts_set_email_first_name_last_name_where_contacts_id=UPDATE messenger.contacts SET first_name = '%1$s', last_name =  '%2$s',email= '%3$s' WHERE id =%4$s;
SQL_select_users_id_from_access_where_token=SELECT users_id FROM messenger.access WHERE deleted_at is NULL and valid_until>SYSDATE()and token ='%1$s';
SQL_insert_into_user_contact_user_id_contact_id_first_name_last_name_created_at_updated_at=INSERT into messenger.user_contact (user_id, contact_id, first_name, last_name, created_at, updated_at) VALUES (%1$s,%2$s,'%3$s','%4$s','%5$s','%6$s');
SQL_set_time_zone= SET time_zone = 'Europe/Kiev';
SQL_select_user_id_contact_id_from_user_contact_where_users_id_contact_id = SELECT user_id,contact_id FROM messenger.user_contact WHERE user_id  =%1$s  and contact_id =%2$s;
SQL_get_Array_users_from_users_like = SELECT * FROM messenger.users WHERE user_name LIKE '%1$s' LIMIT %2$s ,%3$s  ;
SQL_get_common_conversation_id_single_where_users_id1_and_users_id2=SELECT  con.id FROM conversation con JOIN participants par1 ON con.id = par1.conversation_id WHERE if('%1$s'='%2$s',con.creator_id ='%1$s' and con.type ='single'and'%1$s' = all(SELECT pr3.users_id FROM participants pr3 where con.id = pr3.conversation_id), par1.users_id ='%2$s' and con.type ='single' and(con.creator_id ='%1$s'))UNION SELECT  con.id FROM conversation con JOIN participants par1 ON con.id = par1.conversation_id WHERE if('%2$s'='%1$s',con.creator_id ='%2$s' and '%2$s' = all(SELECT pr3.users_id FROM participants pr3 where con.id = pr3.conversation_id), par1.users_id ='%1$s' and con.type ='single' and (con.creator_id ='%2$s'));
SQL_insert_into_conversation_title_name_conversation_photo_id_type_creator_id_created_at_updated_at =INSERT INTO messenger.conversation (title, name_conversation, photo_id, type, creator_id, created_at, updated_at) VALUE ('%1$s','%2$s',%3$s,'%4$s',%5$s,'%6$s','%7$s')
SQL_select_conversation_id_from_conversation_conversation_title_name_conversation_photo_id_type_creator_id_created_at_updated_at =SELECT  id FROM conversation WHERE  title ='%1$s' and name_conversation='%2$s' and photo_id=%3$s and type='%4$s' and creator_id=%5$s and created_at='%6$s' and updated_at='%7$s';
SQL_insert_into_participants_conversation_id_users_id=INSERT into messenger.participants (conversation_id,users_id,last_view) VALUES (%1$s,%2$s,'%3$s');
SQL_select_conversation_all_from_conversation_where_conversation_id_users_id =SELECT  con.id con_id, con.title,con.type,con.name_conversation,con.photo_id,con.creator_id,con.created_at,par.id par_id ,par.last_view  FROM conversation con JOIN participants par ON con.id = par.conversation_id WHERE  con.id =%1$s and par.users_id =%2$s ;
SQL_select_LAST_INSERT_ID = SELECT LAST_INSERT_ID() as id;
SQL_select_ALL_conversation= SELECT con.id AS con_id, con.creator_id AS con_creator_id, con.title AS con_title, con.name_conversation AS con_name_conversation, con.photo_id AS con_photo_id, con.type AS con_type, con.created_at AS con_created_at,par.id as par_id, par.users_id AS par_users_id, par.last_view AS par_last_view, mes.id AS mes_id, mes.sender_id AS mes_sender_id, mes.message_type AS mes_message_type, mes.message AS mes_message, mes.attachment_thumb_url AS mes_attachment_thumb_url, mes.attachment_url AS mes_attachment_url, mes.created_at AS mes_created_at FROM conversation con INNER JOIN participants par ON con.id = par.conversation_id LEFT JOIN messages mes ON con.id = mes.conversation_id WHERE par.users_id = %1$s AND (mes.id = (SELECT mes2.id FROM messages mes2 WHERE mes2.conversation_id = con.id ORDER BY mes2.created_at DESC, mes2.id DESC LIMIT 1) OR mes.id IS NULL);
SQL_select_first_15_participants_in_each_conversation_where_user_id=SELECT participants.users_id, X.id, X.conversation_id, us.id             AS us_id, us.phone          AS us_phone, us.email          AS us_email, us.first_name     AS us_first_name, us.last_name      AS us_last_name, us.user_name      AS us_user_name, us.is_active      AS us_is_active, us.last_online_at AS us_last_online_at FROM participants JOIN ( SELECT Pr1.id, Pr1.conversation_id FROM participants Pr1 JOIN participants Pr2 ON Pr1.conversation_id = Pr2.conversation_id AND Pr1.id >= Pr2.id GROUP BY Pr1.conversation_id, Pr1.id HAVING count(*) <= 15 ) X ON X.id = participants.id JOIN (SELECT con.id FROM conversation con INNER JOIN participants par ON con.id = par.conversation_id WHERE par.users_id = %1$s) comw ON comw.id = X.conversation_id JOIN users us ON us.id = participants.users_id ORDER BY participants.conversation_id, participants.id;
SQL_get_Array_participants_from_participants_where_conversation_id=SELECT * FROM participants WHERE  conversation_id  = %1$s;
SQL_select_participant_id_from_participants_where_user_id_conversation_id=SELECT id FROM participants WHERE users_id = %1$s AND conversation_id = %2$s;
SQL_get_Array_messages_from_messagess_where_conversation_id_date_limit=SELECT *  FROM messages WHERE conversation_id = %1$s AND   (CASE WHEN %2$s=0 THEN TRUE ELSE   id<%2$s END)  AND created_at <= '%3$s'  ORDER by created_at DESC , id DESC LIMIT %4$s;
SQL_insert_into_messages= INSERT INTO messages (conversation_id, sender_id, message_type, message, attachment_thumb_url, attachment_url, created_at) VALUES (%1$s,%2$s,'%3$s','%4$s','%5$s','%6$s','%7$s');
SQL_update_into_access=UPDATE access SET deleted_at = SYSDATE() WHERE token = '%1$s';
SQL_get_Array_users_id_token_device_token= SELECT ac.users_id, ac.token, de.device_token FROM participants par JOIN access ac ON par.users_id = ac.users_id JOIN devices de ON de.id = ac.devices_id WHERE conversation_id = %1$s AND ac.deleted_at IS NULL;


